---
layout: mi-argentina
---

{% include mi-argentina/usuario.html padre="Salud" hijo="Salud" %}

<section>
  <div class="container">
    <div class="row">
      <aside class="col-md-4">
        
        {% include mi-argentina/menu.html active="salud" %}

      </aside>
      <div class="col-md-8">

        <div class="panel panel-default panel-border-primary p-b-2">
          <div class="panel-body">
          <div class="media">
            <div class="media-body media-middle">
              <h2>Centro de salud</h2>
              <p class="m-b-2">Conocé los hospitales y otros centros de salud públicos y privados de todo el país.</p>
            </div>
          </div>

           <ul class="nav nav-tabs">
            <li role="presentation" class="active"><a href="">Mapa</a></li>
            <li role="presentation"><a href="">Listado</a></li>
            <li role="presentation"><a href="">Favoritos</a></li>
          </ul>
          
          <!-- Mensaje agregado/quitado de favorito - accesibilidad -->
          <div aria-live="polite" id="mensajeAccesible" class="sr-only"></div>

          <div class="state-loading m-t-2" id="map-container"><div id="map">&nbsp;</div></div>


           </div>
        </div>   
      </div>
    </div>
  </div>
</section>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

<link href="{{ "/node_modules/bootstrap-switch/css/bootstrap-switch.min.css" | prepend: site.baseurl }}" rel="stylesheet">
<script src="{{ "/node_modules/bootstrap-switch/js/bootstrap-switch.min.js" | prepend: site.baseurl }}"></script>

<script>

var provincia_usuario = "Misiones";

var provincias = [
      {  
         "provincia":"Córdoba",
         "lat":-32.142933,
         "lon":-63.801753
      },
      {  
         "provincia":"Chaco",
         "lat":-26.386431,
         "lon":-60.765831
      },
      {  
         "provincia":"Chubut",
         "lat":-43.788623,
         "lon":-68.526759
      },
      {  
         "provincia":"Buenos Aires",
         "lat":-36.676942,
         "lon":-60.558832
      },
      {  
         "provincia":"Catamarca",
         "lat":-27.335833,
         "lon":-66.947682
      },
      {  
         "provincia":"Entre Ríos",
         "lat":-32.058874,
         "lon":-59.201448
      },
      {  
         "provincia":"Formosa",
         "lat":-24.894973,
         "lon":-59.932441
      },
      {  
         "provincia":"La Pampa",
         "lat":-37.131554,
         "lon":-65.446655
      },
      {  
         "provincia":"Río Negro",
         "lat":-40.405796,
         "lon":-67.22933
      },
      {  
         "provincia":"San Juan",
         "lat":-30.865368,
         "lon":-68.889491
      },
      {  
         "provincia":"Santa Cruz",
         "lat":-48.815485,
         "lon":-69.955762
      },
      {  
         "provincia":"Santa Fe",
         "lat":-30.706927,
         "lon":-60.949837
      },
      {  
         "provincia":"Tierra del Fuego, Antártida e Islas del Atlántico Sur",
         "lat":-82.521518,
         "lon":-50.742749
      },
      {  
         "provincia":"Jujuy",
         "lat":-23.320078,
         "lon":-65.764252
      },
      {  
         "provincia":"Misiones",
         "lat":-26.875397,
         "lon":-54.651697
      },
      {  
         "provincia":"Ciudad Autónoma de Buenos Aires",
         "lat":-34.614493,
         "lon":-58.445856
      },
      {  
         "provincia":"Corrientes",
         "lat":-28.774305,
         "lon":-57.801219
      },
      {  
         "provincia":"La Rioja",
         "lat":-29.685776,
         "lon":-67.181736
      },
      {  
         "provincia":"Salta",
         "lat":-24.299134,
         "lon":-64.814463
      },
      {  
         "provincia":"Santiago del Estero",
         "lat":-27.782412,
         "lon":-63.252387
      },
      {  
         "provincia":"Mendoza",
         "lat":-34.629887,
         "lon":-68.583123
      },
      {  
         "provincia":"Neuquén",
         "lat":-38.641758,
         "lon":-70.118571
      },
      {  
         "provincia":"San Luis",
         "lat":-33.757726,
         "lon":-66.02813
      },
      {  
         "provincia":"Tucumán",
         "lat":-26.9478,
         "lon":-65.364758
      }
   ];

var latitud_usuario;
var longitud_usuario;
provincias.forEach(function(row, key){
  if(row.provincia == provincia_usuario){
    latitud_usuario = row.lat;
    longitud_usuario = row.lon;
  }
})



//Marcar favorito
$(document).on("click",".favorito",function(){
  $("#mensajeAccesible").html("");
  var nombreCentro = $(this).parents(".media").find(".media-body h4").html();

  if($(this).find("i").hasClass("fa-star-o")){
    $(this).find("i").removeClass("fa-star-o").addClass("fa-star text-warning");

    $("#mensajeAccesible").html("El centro " + nombreCentro + " fue agregado a favoritos");
  }
  else{
    $(this).find("i").addClass("fa-star-o").removeClass("fa-star text-warning");
    $("#mensajeAccesible").html("El centro " + nombreCentro + " fue quitado de favoritos");
  }
})


//MAPA
  var initMap = function() {

    // Setup map


    var mapCenter = {lat: latitud_usuario, lng: longitud_usuario};
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 7,
      center: mapCenter,
      scrollwheel: true,
      streetViewControl: false
    });

    // Show markers loaded from spreadsheet

    var markers = [];
    var detalles = [];

    $.ajax({
     url: 'mapa_centro_salud.json',
    //  url: 'https://interfaces.argentina.gob.ar/api/public/v1.0/inap/1S-9FUGj-jUdlHUwoMhaGNaGYNIrKaNs6q9Wmue7T6qY/1',
      data: 'json',
      success: function(response){
      
        var rows = response.establecimientos;
  
        rows.forEach(function(row, key){
          //console.log(rows[key], rows.financiamiento);
          if(key > 0){
          marker = "privado";
          if(row.financiamiento == "Público"){
            marker = "publico";
          }
            var index = markers.length;
            markers[index] = new google.maps.Marker({
              position: {lat: row.lat, lng: row.lon},
              // map: map,
              
             icon: {
               url: 'https://www.argentina.gob.ar/sites/default/files/marker_salud_'+ marker +'.png?id=2',
               size: new google.maps.Size(30, 30),
               origin: new google.maps.Point(0, 0),
               anchor: new google.maps.Point(10, 10)
             }

            });

            detalles[index] = new google.maps.InfoWindow({
              content: '<div class="media"> <div class="media-body"><h5 class="text-primary">'+ row.financiamiento +'</h5><h3>'+ row.nombre + '</h3><h4>'+ row.provincia + ' / ' + row.localidad + '</h4><p>' + row.domicilio + '</p></div> <div class="media-right text-center"><a aria-label="agregar a favoritos" class="favorito"><i class="fa fa-star-o fa-2x m-t-2 m-t-2 p-l-2 p-r-2"></i></a><p class="text-primary m-t-2">1 km</p></div></div>',
              maxWidth: 400
            })

            markers[index].addListener('click', function() {
              closeWindows();
              map.setZoom(15);
              map.setCenter(markers[index].getPosition());
              detalles[index].open(map, markers[index]);

            });

          }

          // }
        })
        

        var mcOptions = {
        enableRetinaIcons: true,
        imageSizes: [20,30,40,50,60,70],
        gridSize: 45,
         styles: [{
            textColor: 'white',
            url: 'http://localhost:4000/proyectos/mi-argentina/v3/img/salud/m1.png',
             width: 45,
             height: 45
        }]
        };

        var markerCluster = new MarkerClusterer(map, markers, mcOptions);


        $('#map-container').removeClass('state-loading');

      },
      error: function(){
        // console.log('nope');
      }
    });

    // Helper clases

    var closeWindows = function(){
      for(i = 0; i < detalles.length; i++){
        detalles[i].close();
      }
    }

    // Geolocation
    window.setGeolocation = function(){


      if (navigator.geolocation) {
        $('.localize').addClass('state-loading disabled');

        if(window.pos == undefined){

          navigator.geolocation.getCurrentPosition(function(position) {
            window.pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            map.setZoom(15);
            map.setCenter(pos);

            $('.localize').removeClass('state-loading disabled');
            $('.navbar-collapse').removeClass('in');

          }, function() {
            // console.log('geo nope')
            $('.localize').removeClass('state-loading disabled');
          });
          
        }else{
          $('.localize').removeClass('state-loading disabled');
          map.setZoom(15);
          map.setCenter(window.pos);
          $('.navbar-collapse').removeClass('in');
        }

      } else {
        $('.localize').addClass('disabled');
        // Browser doesn't support Geolocation
        // handleLocationError(false, infoWindow, map.getCenter());
      }
    }

    setGeolocation();
  }

</script><script src="https://www.argentina.gob.ar/profiles/argentinagobar/themes/argentinagobar/argentinagobar_theme/js/mapas/markerclusterer.js"></script><script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAnjrx-mfaup3A-TQS4DyL0ngfxEqDDBqc&signed_in=true&region=AR&region=AR&callback=initMap"></script>