---
layout: argentina
---

<section class="jumbotron" style="background-image: url('https://www.argentina.gob.ar/sites/default/files/header_mercado_en_tu_barrio_lechuga_1_0.png');">
  <div class="jumbotron_bar">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <ol class="breadcrumb pull-left">
            <li><a href="">Argentina</a></li>
            <li class="active"><span>Mercado en tu barrio</span></li>
          </ol>
          <ul class="list-inline pull-right">
            <li>
              <div class="dropdown">
                <a href="#" class="dropdown-toggle" id="jumbo-menu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Institucional
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="jumbo-menu">
                  <li><a href="#">Objetivos</a></li>
                  <li><a href="#">Beneficios</a></li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="jumbotron_body">
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2 text-center">
          <h2>El Mercado en tu barrio</h2>
          <p>Es un programa para que vos y tu familia puedan comprar productos de calidad, a precios accesibles en un solo lugar y cerca de tu casa.</p>
          <!-- <div class="m-t-2 text-center">
            <a href="#cerca-barrio" class="btn btn-primary btn-success text-center ">¡Buscá que día estará la feria cerca de tu barrio!</a> 
          </div> -->
        </div>
      </div>
    </div>
  </div>
  <div class="overlay"></div>
</section>


<div class="container">
  <section>
    <div id="ferias">

      <h3 id="cerca-barrio" class="text-center m-t-4">¡Buscá qué día estará la feria cerca de tu casa!</h3>
      <div class="row">
        <div class="col-md-8 col-md-offset-2">    
          <div class="form-group m-b-2">
            <input class="form-control search" placeholder="Filtrá las ferias por municipio, día o barrio...">
          </div>
        </div>
      </div>

      <div class="well">
        <h4 class="m-t-2">Esta semana estamos en: </h4>
        <div class="table-responsive">
          <table id="table-semana" class="table table-align-middle">
            <thead>
              <tr>
                <th><a class="sort" data-sort="dia">Día <span class="caret"></span></a></th>
                <th><a class="sort" data-sort="fecha">Fecha <span class="caret"></span></a></th>
                <th><a class="sort" data-sort="barrio">Municipio <span class="caret"></span></a></th>
                <th><a class="sort" data-sort="lugar">Barrio <span class="caret"></span></a></th>
                <th class="text-right">Mapa</th>
              </tr>
            </thead>
            <tbody class="list" id="ferias-semana">
            </tbody>
          </table>
        </div>
      </div>

      <div class="well">
        <h4 class="m-t-2">Las próximas semanas estaremos en: </h4>
        <div class="table-responsive">
          <table id="table-proximas" class="table table-align-middle">
            <thead>
              <tr>
                <th><a class="sort" data-sort="dia">Día <span class="caret"></span></a></th>
                <th><a class="sort" data-sort="fecha">Fecha <span class="caret"></span></a></th>
                <th><a class="sort" data-sort="barrio">Municipio <span class="caret"></span></a></th>
                <th><a class="sort" data-sort="lugar">Barrio <span class="caret"></span></a></th>
                <th class="text-right">Mapa</th>
              </tr>
            </thead>
            <tbody class="list" id="ferias-proximas">
            </tbody>
          </table>
        </div> 
      </div>

    </div>
  </section>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.3.0/list.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/locale/es.js"></script>

<script>

jQuery(function(){

  window.ferias = {
    semana: [],
    proximas: []
  }

  var test = 0;

  jQuery.getJSON('https://spreadsheets.google.com/feeds/list/1gDUaA7UVYxMNmY4Gww150S8yYBdVBfMvAGovHHQ5FfM/1/public/values?alt=json', 
    function (data) {
      window.raw = data.feed.entry;

      jQuery.each( raw, function( key, item ) {
        var fecha = moment(item.gsx$fecha.$t, "DD/MM/YYYY");
        
        if( fecha.startOf('day').isBetween( moment().startOf('day').add(test, 'day'), moment().add(test, 'day').day(7) ) ){
          ferias.semana.push( item );

        } else if( fecha.startOf('day').isAfter( moment().add(test, 'day').day(7) ) ){
          ferias.proximas.push( item );
        }
      });

      printFerias();
  });

  var getTr = function(item){

    var mapa = '';

    if(item.gsx$mapa.$t != '') {
      mapa = '<a class="btn btn-primary btn-sm m-b-0" style="min-width: 100px;" target="_blank" href="'+ item.gsx$mapa.$t + '"><i class="fa fa-map-marker"></i> Ver mapa</a>';
    }

    var html = '<tr class="item">';
        html += '<td class="dia">'+ item.gsx$dia.$t + '</td>';
        html += '<td class="fecha">'+ item.gsx$fecha.$t + '</td>';
        html += '<td class="barrio">'+ item.gsx$barrio.$t + '</td>';
        html += '<td class="lugar">'+ item.gsx$lugar.$t + '</td>';
        html += '<td class="mapa text-right">'+ mapa + '</td></tr>';

    return html;
  }

  window.printFerias = function(){

    // console.log(ferias);

    jQuery.each( ferias.semana, function( key, item ) {
      jQuery('#ferias-semana').append( getTr( item, false ) );
    });
    
    jQuery.each( ferias.proximas, function( key, item ) {
      jQuery('#ferias-proximas').append( getTr( item, false ) );
    });


    var listOptions = {
      valueNames: [ 'barrio', 'dia', 'fecha', 'lugar' ]
    };

    var feriasSemanaList = new List('table-semana', listOptions);
    var feriasProximasList = new List('table-proximas', listOptions);



    jQuery('.search').on("keyup",function(){
        feriasSemanaList.search(jQuery(".search").val());
        feriasProximasList.search(jQuery(".search").val());
    });

  }

});

</script>


