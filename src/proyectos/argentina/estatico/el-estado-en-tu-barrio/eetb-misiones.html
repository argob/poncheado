---
layout: argentina
---

<section class="jumbotron" style="background-image: url('img/Imagen_EETB.jpg');">
  <div class="jumbotron_bar">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <ol class="breadcrumb pull-left">
            <li><a href="">Inicio</a></li>
            <li><a href="">El Estado en tu Barrio</a></li>
            <li class="active">Misiones</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <div class="jumbotron_body">
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2 text-center">
          <p><img src="img/presidencia.svg" style="width: 160px;"> <img src="img/02_Logo_PlanBelgrano-01b.svg" style="width: 160px;">  </p>
          <p><img src="img/El-estado-en-tu-barrrio.png" style="width: 320px;"> </p>
          <p>e acercamos el Estado para que vos y tu familia puedan hacer los trámites cerca de sus casas y conozcan los servicios a los que pueden acceder de una manera simple y rápida.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="overlay"></div>
</section>


<div class="container lugares-mapa hidden">
  <section>
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h2 class="text-center">En <span data-render="mes"></span> estamos en estos lugares</h2>
        <div id="map" style="height: 400px;"></div>
      </div>
    </div>
  </section>

  <section>
    <div class="row" data-render="barrios">
    </div>
  </section>    
</div>
<section>
  <div class="container">
      <div class="row">    
        <div class="container lugares-mensaje hidden">
          <div class="row">
            <div class="col-md-8 col-md-offset-2 text-center m-y-2">
              <h2>Por el momento no estamos en Misiones</h2>
              <p>Registrate para enterarte cuándo vamos a estar en tu barrio.</p>
              <div class="m-t-1 text-center">
                  <a href="https://contacto.casarosada.gob.ar/elestadoentubarrio/" class="btn btn-primary btn-success btn-lg">Registrate</a> 
              </div>                
            </div>
          </div>
        </div>
        <div class="col-md-12"> 
          <p class="text-center">Mirá Dónde estuvimos en todo el país.</p>
          <div class="m-t-1 text-center">
              <a href="eetb-donde-estuvimos.html" class="btn btn-primary btn-success btn-lg">Dónde estuvimos</a> 
          </div>
        </div>  
      </div>
  </div>
</section>     
<section>
  <div class="container">
    <hr class="m-y-2">
    <div id="servicios">
      <div class="row">    
        <div class="col-md-8 col-md-offset-2">
          <h2 class="text-center">Estos son los servicios y trámites que te acercamos</h2>
          <form role="search">
            <div class="input-group input-group-lg">
              <input class="form-control search" type="text" placeholder="Buscá el trámite que necesitás">
              <span class="input-group-btn">
                <button id="search" class="btn btn-primary" type="button"><span class="glyphicon glyphicon-search"></span></button>
              </span>
            </div>
          </form>
        </div>  
      </div>
      <div class="row">
        <div class="col-md-6 col-md-offset-3">

        <div class="list" data-render="servicios">
        </div>      

        </div> 
      </div>
    </div>
  </div>
</section>
<section>
  <div class="container">
    <hr class="m-y-2">
    <div class="row">    
      <div class="col-md-8 col-md-offset-2 text-center">
        <h2>Enterate cuando estemos cerca de tu casa</h2>
        <div class="row">
          <div class="col-md-6 col-md-offset-3 text-center">
              <p>Te avisamos cuando vamos a tu barrio y te mantenemos informado sobre las novedades de los servicios del Estado.</p>
              <div class="m-t-3 text-center">
                  <a href="https://contacto.casarosada.gob.ar/elestadoentubarrio/" class="btn btn-primary btn-success btn-lg">Registrate</a> 
              </div>  
          </div> 
        </div> 
      </div>  
    </div>
  </div>
</section>
<section>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h2 class="text-center m-b-2">Mirá las fotos de El Estado en tu Barrio en Misiones</h2>
      </div>
      <div class="col-md-4">
          <img src="../../../casarosada/img/casa-rosada-2.jpg" class="img-responsive img-rounded m-b-1">
      </div>      
      <div class="col-md-4">
         <img src="../../../casarosada/img/argentina_3.jpg" class="img-responsive img-rounded m-b-1">
      </div>
      <div class="col-md-4">
         <img src="../../../casarosada/img/argentina_3.jpg" class="img-responsive img-rounded m-b-1">
      </div>
    </div>    
  </div>
</section>
<section class="bg-gray">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
          <h2 class="text-center">Mirá de qué se trata el Estado en tu Barrio</h2>
            <div class="row">
              <div class="col-sm-4 col-sm-offset-4">
                <a class="panel panel-default" target="_blank" href="https://www.youtube.com/playlist?list=PLry2W0bcBZ9wVhqAZJoYGBw2kKO4HL22A">
                  <div class="panel-body">
                    <div class="media">
                      <div class="media-left media-middle">
                        <i class="fa fa-video-camera fa-fw fa-3x text-secondary"></i>
                      </div>
                      <div class="media-body media-middle">
                        <h3>Videos</h3>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
            </div>      
      </div>
    </div>
  </div>
</section>
<section>
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <div class="section-actions is_area social-share">
          <p>Compartir en <br> redes sociales</p>
          <ul class="list-inline">
            <li><a href="#"><i class="fa fa-facebook"></i></a></li>
            <li><a href="#"><i class="fa fa-twitter "></i></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>    
</section>

<script src="{{ "/node_modules/list.js/dist/list.min.js" | prepend: site.baseurl }}"></script>
<script src="{{ "/node_modules/moment/min/moment.min.js" | prepend: site.baseurl }}"></script>
<script src="{{ "/node_modules/moment/locale/es.js" | prepend: site.baseurl }}"></script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7QiqZwOu8TbwtitMp-vDDishkTvc0_X8&signed_in=true&region=AR&callback=initMap"></script>

<script>

  $('[data-render=mes]').text( moment().format('MMMM') );

  var initMap = function(){

    // Setup map

    var mapCenter = {lat: -41.2148693, lng: -66.3996161};
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 4,
      center: mapCenter,
      scrollwheel: false
    });

    var templates = {
      barrio: '<div class="col-md-4 m-y-1"><h4 class="m-t-2">{lugar}</h4><p><strong>Fecha:</strong> Desde el {inicio} hasta el {fin}.</p><p><strong>Horario:</strong> de {hora}</p><p><strong>Dirección:</strong> {direccion}</p></div>',
      servicios: '<h5 class="m-t-3">{categoria}</h5><div id="servicios-{i}"><ul class="list">',
    }

    var listado = [];
    var markers = [];
    var categoriasServicios = [];
    var listadoServicios = [];

    var render = {
      barrios: function( ){

        $('[data-render=barrios]').html('');

        $.each(listado, function(index, item){

            var html = templates.barrio;

            html = html
            .replace(/{inicio}/gi, item.inicio)
            .replace(/{fin}/gi, item.fin)
            .replace(/{hora}/gi, item.hora)
            .replace(/{direccion}/gi, item.direccion)
            .replace(/{lugar}/gi, item.lugar);

            $('[data-render=barrios]').append( html );

        });

        if( $('[data-render=barrios] > div').length == 0 ){
          $('.lugares-mensaje').removeClass('hidden');
        }else{
          $('.lugares-mapa').removeClass('hidden');
        }


      },
      servicios: function( ){

        $('[data-render=servicios]').html('');

        window.serviciosList = [];

        $.each(listadoServicios, function(index, items){

          var html = templates.servicios;

          html = html
          .replace(/{categoria}/gi, categoriasServicios[index])
          .replace(/{i}/gi, index);

          $.each(items, function(index, item){
            html += '<li><span class="servicio">'+ item +'.</span></li>';
          });

          $('[data-render=servicios]').append( html + '</ul></div>' );

          var listOptions = { 
            valueNames: [ 'servicio' ],
            fuzzySearch: {
              searchClass: "search",
              location: 0,
              distance: 100,
              threshold: 0.4,
              multiSearch: true
            }

          };
          serviciosList[index] = new List('servicios-'+ index, listOptions);

        });
      }      
    }

    $.ajax({
      url: 'https://spreadsheets.google.com/feeds/list/1uQHpsEICNl5SMBmsQZYse4dUo7DySYwGeBz9xh2NQC8/7/public/values?alt=json',
      data: 'json',
      success: function(response){

        var latlngbounds = new google.maps.LatLngBounds();

        $.each(response.feed.entry, function(index, row){

          if( moment(row.gsx$fin.$t, 'DD-MM-AAAA').isAfter( moment() ) && moment(row.gsx$inicio.$t, 'DD-MM-AAAA').isBefore( moment().add(30, 'days') ) ){

            listado.push({
              inicio: row.gsx$inicio.$t,
              fin: row.gsx$fin.$t,
              hora: row.gsx$hora.$t,
              direccion: row.gsx$direccion.$t,
              lugar: row.gsx$lugar.$t
            });

            var index = markers.length;
            markers[index] = new google.maps.Marker({
              map: map,
              position: {lat: parseFloat(row.gsx$latitud.$t), lng: parseFloat(row.gsx$longitud.$t)},
              title: row.gsx$lugar.$t,
              icon: {
                url: 'https://www.argentina.gob.ar/sites/default/files/marker.png',
                size: new google.maps.Size(20, 20),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(10, 10)
              }
            });

            latlngbounds.extend( new google.maps.LatLng( parseFloat(row.gsx$latitud.$t), parseFloat(row.gsx$longitud.$t) ) );

            markers[index].addListener('click', function() {
              $('[data-render=barrios] > div').removeClass('bg-gray').eq( index ).addClass('bg-gray');
              // map.setCenter( markers[index].getPosition() );
              // map.setZoom( 10 );
            });
          }

        });

        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds); 

        render.barrios();

      }
    });

    $.ajax({
      url: 'https://spreadsheets.google.com/feeds/list/1Ex6cZfAfaAqW7EZAuHMr9Vf6TbyRq2OaTDDfrK5Mn0I/12/public/values?alt=json',
      data: 'json',
      success: function(response){

        $.each(response.feed.entry, function(index, row){
          if( categoriasServicios.indexOf( row.gsx$categoria.$t ) == -1 ){
            categoriasServicios.push( row.gsx$categoria.$t )
            listadoServicios[ categoriasServicios.length - 1 ] = [ row.gsx$servicio.$t ];
          }else{
            var categoria = categoriasServicios.indexOf( row.gsx$categoria.$t );
            listadoServicios[ categoria ].push( row.gsx$servicio.$t );
          }
        });
        render.servicios();
      }
    });


    $('body').on('click', '[data-render=barrios] > div', function(){
      $('[data-render=barrios] > div').removeClass('bg-gray').eq( $(this).index() ).addClass('bg-gray');
      map.setCenter( markers[$(this).index()].getPosition() );
      map.setZoom( 10 );
    });

    $('body').on('mouseover', '[data-render=barrios] > div', function(){
          $('[data-render=barrios] > div').css('cursor', 'pointer');
    });

    $('#search').on('click', function(event){
      buscar();
      event.preventDefault();
    });

    $('form[role=search]').on('submit', function(event){
      buscar();
      event.preventDefault();
    });



    var buscar = function(){
      var busqueda = $('.search').val()
      $.each(serviciosList, function(index, item){
        serviciosList[index].fuzzySearch( busqueda );

        if(serviciosList[index].matchingItems.length == 0){
          $('#servicios-'+ index ).prev().addClass('hidden');
        }else{
          $('#servicios-'+ index ).prev().removeClass('hidden');
        }
      })
    }


  };

</script>

