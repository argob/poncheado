---
layout: argentina
---

<section class="jumbotron" style="background-image: url('img/Imagen_EETB.jpg');">
  <div class="jumbotron_bar">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <ol class="breadcrumb pull-left">
            <li><a href="/">Inicio</a></li>
            <li><a href="/elestadoentubarrio">El Estado en tu Barrio</a></li>
            <li class="active">Dónde estuvimos</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <div class="jumbotron_body">
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2 text-center">
          <p><img src="/sites/default/files/presidencia.svg" style="width: 160px;"> </p>
          <p><img src="/sites/default/files/el-estado-en-tu-barrrio.png" style="width: 320px;"> </p>
          <p>Te acercamos el Estado para que vos y tu familia puedan hacer los trámites cerca de sus casas y conozcan los servicios a los que pueden acceder de una manera simple y rápida.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="overlay"></div>
</section>


<div class="container">
  <section>
    <div class="row">
      <div class="col-md-12">
        <h2 class="text-center">Dónde estuvimos</h2>
        <div id="map" style="height: 700px;"></div>
      </div>
    </div>
  </section>
</div>
<section>
  <div class="container">
    <hr class="m-y-2">
    <div class="row">    
      <div class="col-md-8 col-md-offset-2 text-center">
        <h2>Enterate cuando estemos cerca de tu casa</h2>
        <div class="row">
          <div class="col-md-6 col-md-offset-3 text-center">
              <p>Te avisamos cuando vamos a tu barrio y te mantenemos informado sobre las novedades de los servicios del Estado.</p>
              <div class="m-t-3 text-center">
                  <a href="https://contacto.casarosada.gob.ar/elestadoentubarrio/" class="btn btn-primary btn-success btn-lg">Registrate</a> 
              </div>  
          </div> 
        </div> 
      </div>  
    </div>
  </div>
</section>
<section class="bg-gray">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h2 class="text-center">Mirá de qué se trata el Estado en tu Barrio</h2>
          <div class="row">
            <div class="col-sm-4 col-sm-offset-4">
              <a class="panel panel-default" href="#">
                <div class="panel-body">
                  <div class="media">
                    <div class="media-left media-middle">
                      <i class="fa fa-video-camera fa-fw fa-3x text-secondary"></i>
                    </div>
                    <div class="media-body media-middle">
                      <h3>Videos</h3>
                    </div>
                  </div>
                </div>
              </a>
            </div>
          </div>      
      </div>
    </div>
  </div>
</section>


<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/locale/es.js"></script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7QiqZwOu8TbwtitMp-vDDishkTvc0_X8&signed_in=true&region=AR&callback=initMap"></script>

<script>

  var initMap = function(){

    // Setup map
    var mapCenter = {lat: -41.2148693, lng: -66.3996161};
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 4,
      center: mapCenter,
      scrollwheel: false
    });

    // Setup datos
    var markers = [];
    var details = [];

    window.data = {
      loaded: []
    };
    data.load = function(provincia){
     
      return $.ajax({
        url: 'https://spreadsheets.google.com/feeds/list/1uQHpsEICNl5SMBmsQZYse4dUo7DySYwGeBz9xh2NQC8/'+ provincia +'/public/values?alt=json',
        dataType: 'json',
        success: function(response){
          data['loaded'].push(response.feed.entry);
        },
        error: function(response){
          console.log('Hubo un error al momento de cargar los datos. Volvé a intentarlo nuevamente.');
        }
      });
    }

    var provincias = 14;
    var toLoad = [];
    for(i = 1; i <=  provincias; i++){
      toLoad.push( data.load(i) );
    }

    $.when.apply($, toLoad).then(function(){
 
      var latlngbounds = new google.maps.LatLngBounds();

        $.each(data.loaded, function(i, provincia){

          $.each(provincia, function(index, row){

            if( moment(row.gsx$fin.$t, 'DD-MM-AAAA').isBefore( moment() ) ){

              var index = markers.length;
              markers[index] = new google.maps.Marker({
                map: map,
                position: {lat: parseFloat(row.gsx$latitud.$t), lng: parseFloat(row.gsx$longitud.$t)},
                title: row.gsx$lugar.$t,
                icon: {
                  url: 'https://www.argentina.gob.ar/sites/default/files/marker.png',
                  size: new google.maps.Size(20, 20),
                  origin: new google.maps.Point(0, 0),
                  anchor: new google.maps.Point(10, 10)
                }
              });

              details[index] = new google.maps.InfoWindow({
                content: '<h4>'+ row.gsx$lugar.$t +'</h4><p><strong>Fecha:</strong> Desde el '+ row.gsx$inicio.$t +' hasta el '+ row.gsx$fin.$t +'.</p><p><strong>Horario:</strong> de '+ row.gsx$hora.$t +'</p><p><strong>Dirección:</strong> '+ row.gsx$direccion.$t +'</p>'
              });

              latlngbounds.extend( new google.maps.LatLng( parseFloat(row.gsx$latitud.$t), parseFloat(row.gsx$longitud.$t) ) );

              markers[index].addListener('click', function() {
                closeWindows();
                details[index].open(map, markers[index]);
              });
            }

          });
        });

        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds); 
 
    });


    var closeWindows = function(){
      for(i = 0; i < details.length; i++){
        details[i].close();
      }
    }

  };

</script>


