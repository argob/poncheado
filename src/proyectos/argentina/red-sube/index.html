---
layout: argentina
---

<style>

  #trip-list .fa-arrow-right {
    vertical-align: middle;
    line-height: 90px;
  }

  .row-flex > div {
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-self: flex-end;
  }

  #trip-list .panel {
    position: relative;
  }
  .delete-trip {
    position: absolute;
    top: -12px;
    right: -12px;
    font-size: 24px;
    line-height: 24px;
  }

  @media only screen and (min-width: 768px) {
    #simulator-container {
      padding-right: 3rem !important;
      padding-left: 3rem !important;
    }
  }

</style>


<div class="row">
  <div class="col-xs-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
    <h1 class="activities-sidbar">Calculá tu descuento de RED SUBE</h1>
    <div class="section-actions social-share">
      <p>Compartir en<br> redes sociales</p>
      <div class="item-list">
        <ul class="list-inline">
          <li class="first"><a href="http://www.facebook.com/sharer/sharer.php?u=https://www.argentina.gob.ar/redsube/simulador&amp;title=Simulador de RED SUBE"><span class="sr-only">Compartir en Facebook</span><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
          <li><a href="https://twitter.com/share"><span class="sr-only">Compartir en Twitter</span><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
          <li class="last"><a href="https://plus.google.com/share?url=https://www.argentina.gob.ar/redsube/simulador"><span class="sr-only">Compartir en Google Plus</span><i class="fa fa-google-plus" aria-hidden="true"></i></a></li>
        </ul>
      </div>
    </div>
    <hr>

    <p>Cargá el precio de tu boleto y en caso de que hagas 1 o más combinaciones en menos de 2 horas, calculamos el descuento que te corresponde. El descuento de la <strong>RED SUBE</strong> se suma con la <strong>Tarifa Social Federal</strong> y se complementa con la tarifa escalonada del subte. <a href="/tarifa-social-federal-sube" target="_blank">Averiguá si te corresponde la Tarifa Social</a>.</p>
    <p>Si no conocés la nueva tarifa, <a href="/redsube/tarifas-de-transporte-publico-amba-febrero-2018" target="_blank">consultá los valores de AMBA</a>.</p>

    <div id="simulator-container" class="well m-t-3">
      <form action="#" class="m-b-0">

        <p class="h5">Cargá tu viaje diario</p>

        <div class="row">
          <div class="col-xs-12 col-sm-4">
            <div class="form-group">
              <label for="ride-transport">Transporte</label>
              <select class="form-control" id="ride-transport">
                <option value="bus">Colectivo</option>
                <option value="train">Tren</option>
                <option value="subway">Subte</option>
              </select>
            </div>
          </div>
          <div class="col-xs-12 col-sm-4">
            <div class="form-group">
              <label for="ride-price">Costo del boleto</label>
              <div class="input-group">
                <span class="input-group-addon">$</span>
                <input type="number" class="form-control" id="ride-price" placeholder="0.00" min="0">
              </div>
            </div>
          </div>
          <div class="col-xs-12 col-sm-4">
            <label for="ride-price" class="hidden-xs">&nbsp;</label><br class="hidden-xs">
            <a id="js-add-trip" href="#" class="btn btn-success btn-block">Agregar viaje</a>
          </div>
        </div>

        <div id="js-subway-alert" class="alert alert-warning m-b-3 hidden">
          Si hacés dos viajes consecutivos en subte no aplica el descuento de RED SUBE porque podés hacer combinación en la red de subtes.
        </div>

        <div id="js-number-alert" class="alert alert-danger m-b-3 hidden">
          El costo del viaje debe ser un número mayor a cero.
        </div>

        <div id="trip-list" class="row">
        </div>

        <div id="js-time-alert" class="alert alert-info hidden">
          Recordá que el descuento aplica a los viajes que hagas hasta 2 horas después que empezaste el primero. Una vez pasado ese tiempo, empieza el ciclo de nuevo.
        </div>

        <hr>

        <p class="h5 m-b-2">Calculá tu descuento mensual</p>

        <div class="row">
          <div class="col-xs-12 col-sm-4">
            <div class="form-group m-b-1">
              <label>¿Tenés tarifa social?</label>
              <div class="btn-group btn-group-justified" data-toggle="buttons"> 
                <label class="btn btn-default"><input class="form-radio" type="radio" name="tarifa-social" value="yes">Si</label>
                <label class="btn btn-default active"><input class="form-radio" type="radio" name="tarifa-social" value="no" checked="">No</label>
              </div>
            </div>
          </div>
          <div class="col-xs-12 col-sm-4">
            <div class="form-group m-b-1">
              <label>¿Viajás ida y vuelta?</label>
              <div class="btn-group btn-group-justified" data-toggle="buttons"> 
                <label class="btn btn-default active"><input class="form-radio" type="radio" name="round-trip" value="yes" checked="">Si</label>
                <label class="btn btn-default"><input class="form-radio" type="radio" name="round-trip" value="no">No</label>
              </div>
            </div>
          </div>
          <div class="col-xs-12 col-sm-4">
            <div class="form-group m-b-1">
              <label for="ride-times">Viajes por semana</label>
              <input type="number" class="form-control" id="ride-times" value="5" min="1">
            </div>
          </div>
        </div>

        <div id="js-times-alert" class="alert alert-danger m-b-3 hidden">
          La cantidad de viajes por semana debe ser mayor a cero.
        </div>

        <br class="hidden-xs">

        <ul class="list-unstyled m-y-0">
          <li id="js-2" class="m-b-2 hidden">
            <div class="media">
              <div class="media-left media-middle"><span class="fa fa-check text-success fa-2x"></span></div>
              <div class="media-body media-middle">Tenés un 50% de descuento en el 2<sup>do</sup> viaje<span id="js-3"> y un 75% en los siguientes</span>.</div>
            </div>
          </li>
          <li id="js-social" class="m-b-2 hidden">
            <div class="media">
              <div class="media-left media-middle"><span class="fa fa-check text-success fa-2x"></span></div>
              <div class="media-body media-middle">Tenés el descuento de Tarifa Social en colectivos y trenes.</div>
            </div>
          </li>
          <li id="js-subway" class="m-b-2 hidden">
            <div class="media">
              <div class="media-left media-middle"><span class="fa fa-check text-success fa-2x"></span></div>
              <div class="media-body media-middle">Tenés descuento de la tarifa escalonada de subte. No está calculado en este simulador.</div>
            </div>
          </li>
        </ul>

      </form>

      <div id="results" class="hidden">
        <hr>

        <p class="h5 m-b-2">Tus resultados</p>

        <div class="row numbers row-flex p-t-0 p-b-1">
          <div class="col-xs-6 col-sm-4">
            <div class="h3 text-gray" data-render="going">-</div>
            <p class="text-muted">Viaje de ida</p>
          </div>
          <div class="col-xs-6 col-sm-4">
            <div class="h3 text-gray" data-render="returning">-</div>
            <p class="text-muted">Viaje de vuelta</p>
          </div>
          <div class="col-xs-12 col-sm-4">
            <div class="h2 text-success" data-render="saving">-</div>
            <p class="text-muted">Tu descuento por mes</p>
          </div>
        </div>
        
      </div>

    </div>

    <div class="b-t-2">
      <a href="/redsube" class="btn btn-link">Volver a RED SUBE</a>
    </div>

  </div>
</div>



<script>

  var templates = {
    item: '<div class="col-xs-4 col-sm-2"><div class="panel m-y-1"><a class="delete-trip" data-delete="{index}" href="#"><span class="fa fa-times-circle text-danger"></span></a><div class="panel-body p-x-0 text-center"><p class="h2 m-t-0"><span class="fa fa-{transport}"></span><br><small>${price}</small></p></div></div></div>',
    arrow: '<div class="col-xs-2 col-sm-1 text-center"><span class="fa fa-arrow-right"></span></div>',
  }

  var data = {
    roundtrip: 'yes',
    tarifasocial: 'no',
    times: 5,
    monthly: 40,
    anysubway: false,
    trips: []
  };

  var multiplier = [1, 0.5, 0.25, 0.25, 0.25, 0.25];

  var renderNumber = function(number){
    return parseFloat(number).toFixed(2).replace('.', ',');
  }

  var checkButton = function(){

    // Deshabilita agregar mas viajes cuando hay 6
    if(data.trips.length == 6){
      jQuery('#js-add-trip').addClass('disabled');
    }else{
      jQuery('#js-add-trip').removeClass('disabled');

      // Deshabilita agregar mas viajes cuando hay dos subtes consecutivos
      if(data.trips.length > 0 && data.trips[data.trips.length-1].transport == 'subway' && jQuery('#ride-transport').val() == 'subway' ){
        jQuery('#js-add-trip').addClass('disabled');
        jQuery('#js-subway-alert').removeClass('hidden');
      }else{
        jQuery('#js-add-trip').removeClass('disabled');
        jQuery('#js-subway-alert').addClass('hidden');
      }

      // Alerta de tiempo cuando hay más de 3 viajes
      if(data.trips.length > 3){
        jQuery('#js-time-alert').removeClass('hidden');
      }else{
        jQuery('#js-time-alert').addClass('hidden');

      }

    }
  }

  var calculateTrip = function(){

    // Borro el listado de viajes
    jQuery('#trip-list').html('');

    // Defino las variables que voy a usar para los calculos
    var total = 0.00;
    var going = 0.00;
    var returning = 0.00;
    var subwaytimes = 0;

    // Leo la configuración
    data.roundtrip = jQuery('[name=round-trip]:checked').val();
    data.tarifasocial = jQuery('[name=tarifa-social]:checked').val();
    data.times = jQuery('#ride-times').val();

    // Si salta la validación de cantidad de viajes y no es válido, lo defino como 1
    if(data.times == "" || isNaN(data.times) || data.times < 0 ){
      jQuery('#js-times-alert').addClass('hidden');
      jQuery('#ride-times').val(1);
      data.times = 1;
    }

    // Itero por cada viaje
    jQuery.each(data.trips, function(index, item){

      // Guardo el precio real y lo sumo al total
      var realprice = item.price;
      total += parseFloat(item.price);

      // Si hay un subte, lo anoto
      if(item.transport == 'subway'){
        data.anysubway = true;

      // Si no es subte y si hay tarifa social, lo calculo
      }else if(data.tarifasocial == 'yes'){
        realprice = realprice * 0.45;
      }

      // Lo agrego a la ida
      var discountprice = realprice * multiplier[index];
      realprice - discountprice < 8 ? going += discountprice : going += realprice - 8;

      // Lo agrego a la vuelta
      discountprice = realprice * multiplier[data.trips.length - index - 1];
      realprice - discountprice < 8 ? returning += discountprice : returning += realprice - 8;

      // Armo el html del item
      var newtrip = templates.item;
      newtrip = newtrip.replace('{transport}', item.transport).replace('{price}', renderNumber(item.price)).replace('{index}', index);

      // Si no es el primero agrego una flecha
      if(index > 0){
        jQuery('#trip-list').append(templates.arrow);
      }

      // Agrego el html del viaje
      jQuery('#trip-list').append(newtrip);

    });

    // Hace logicas diferentes si viaja ida y vielta o no
    if(data.roundtrip == 'yes'){
      data.monthly = parseInt(data.times) * 4 * 2;
      var saving = (total - going + total - returning) * parseInt(data.times) * 4;
      jQuery('[data-render=returning]').text('$'+ renderNumber(returning)).parent().removeClass('hidden');

    }else{
      data.monthly = parseInt(data.times) * 4;
      var saving = (total - going) * parseInt(data.times) * 4;
      jQuery('[data-render=returning]').parent().addClass('hidden');
    }

    // Imprime los valores de ida y ahorro
    jQuery('[data-render=going]').text('$'+ renderNumber(going));
    jQuery('[data-render=saving]').text('$'+ renderNumber(saving));

    checkButton();

    // Muestro los resultados si hay por lo menos un viaje
    if(data.trips.length == 0){
      jQuery('#results').addClass('hidden');
    }else{
      jQuery('#results').removeClass('hidden');

      jQuery('#js-2, #js-3, #js-social, #js-subway').addClass('hidden');

      // Muestra los beneficios
      if(data.trips.length > 1){
        jQuery('#js-2').removeClass('hidden');
      }
      if(data.trips.length > 2){
        jQuery('#js-3').removeClass('hidden');
      }
      if(data.tarifasocial == 'yes'){
        jQuery('#js-social').removeClass('hidden');
      }
      if(data.monthly > 20 && data.anysubway){
        jQuery('#js-subway').removeClass('hidden');
      }

    }

  }

  // Agregar un viaje
  jQuery('body').on('click', '#js-add-trip:not(.disabled)', function(event){
    event.preventDefault();

    // toma los valores
    var transport = jQuery('#ride-transport').val();
    var price = parseFloat(jQuery('#ride-price').val());

    // Valida
    if( isNaN(price) || price < 0){
      jQuery('#js-number-alert').removeClass('hidden');

    }else{
      jQuery('#js-number-alert').addClass('hidden');
      data.trips.push({
        transport: transport,
        price: price
      });
    }

    // Imprime
    calculateTrip();

  });

  // Eliminar un viaje
  jQuery('body').on('click', '#trip-list .delete-trip', function(event){
    event.preventDefault();

    data.trips.splice(jQuery(this).data('delete'), 1);
    calculateTrip();
  });

  // Modificar ida y vuelta
  jQuery('body').on('change', '[name=round-trip]', function(event){
    event.preventDefault();
    calculateTrip();
  });
  
  // Modificar tarifa social
  jQuery('body').on('change', '[name=tarifa-social]', function(event){
    event.preventDefault();
    calculateTrip();
  });

  // Modificar la cantidad de viajes
  jQuery('body').on('change keyup click', '#ride-times', function(event){
    event.preventDefault();

    data.times = jQuery('#ride-times').val();

    if(data.times == "" || isNaN(data.times) || data.times < 0 ){
      jQuery('#js-times-alert').removeClass('hidden');
    }else{
      jQuery('#js-times-alert').addClass('hidden');
      calculateTrip();
    }
  });

  // Casos especiales para el subte
  jQuery('body').on('change', '#ride-transport', function(event){
    event.preventDefault();

    if(jQuery(this).val() == 'subway'){
      jQuery('#ride-price').attr('disabled', true).val(7.5);
    }else{
      jQuery('#ride-price').removeAttr('disabled').val('');
    }

    checkButton();
  });
  
</script>