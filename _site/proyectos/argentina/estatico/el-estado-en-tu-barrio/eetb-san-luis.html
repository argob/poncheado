<!DOCTYPE html>
<!--[if IEMobile 7 ]> <html lang="es"class="iem7"> <![endif]-->
<!--[if lt IE 7 ]> <html lang="es" class="ie6 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7 ]>    <html lang="es" class="ie7 lt-ie8"> <![endif]-->
<!--[if IE 8 ]>    <html lang="es" class="ie8"> <![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html lang="es"><!--<![endif]-->
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Banco de Pruebas</title>
  <meta name="description" content="Base de html y css para la creación de sitios pertenecientes a la Administración Pública Nacional de la República Argentina.">
  <meta name="author" content="Presidencia de la Nación">
  <link rel="shortcut icon" href="/favicon.ico">

  <!-- Nav and address bar color -->
  <meta name="theme-color" content="#0072b8">
  <meta name="msapplication-navbutton-color" content="#0072b8">
  <meta name="apple-mobile-web-app-status-bar-style" content="#0072b8">

  <meta property="og:url" content="http://localhost:4000/proyectos/argentina/estatico/el-estado-en-tu-barrio/eetb-san-luis.html" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Banco de Pruebas" />
  <meta property="og:description" content="Base de html y css para la creación de sitios pertenecientes a la Administración Pública Nacional de la República Argentina." />
  <meta property="og:image" content="/ejemplos/img/jumbotron.jpg" />
  <meta property="og:locale" content="es_AR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Banco de Pruebas" />
  <meta name="twitter:description" content="Base de html y css para la creación de sitios pertenecientes a la Administración Pública Nacional de la República Argentina." />
  <meta name="twitter:image" content="/ejemplos/img/jumbotron.jpg" />

  <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
  <link href="/vendor/poncho/dist/css/droid-serif.css" rel="stylesheet">
  <link href="/node_modules/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
  <link href="/node_modules/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <!--<link href="/node_modules/chosen-js/chosen.css" rel="stylesheet">-->
  <link href="/node_modules/flag-icon-css/css/flag-icon.css" rel="stylesheet"> 
  <!-- <link href="/vendor/poncho/dist/css/poncho.css" rel="stylesheet">
  <link href="/vendor/iconos/dist/css/icono-arg.css" rel="stylesheet"> -->
  <link href="http://argob.github.io/poncho/node_modules/argob-poncho/dist/css/poncho.min.css" rel="stylesheet">
  <link href="http://argob.github.io/poncho/node_modules/argob-poncho/dist/css/icono-arg.css" rel="stylesheet">
  <link href="/css/argentina.css" rel="stylesheet">
  <link href="/css/docs.css" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="/node_modules/html5shiv/html5shiv.js"></script>
      <script src="/node_modules/respond.js/respond.min.js"></script>
  <![endif]-->  
    
</head>

    <script src="/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <!--<script src="/node_modules/chosen-js/chosen.jquery.js"></script>-->

  <body>

    
<header>


  <nav class="navbar navbar-top navbar-default" role="navigation">
    <div class="container">
      <div>

        <div class="navbar-header">
          <a class="navbar-brand" href="/proyectos/argentina/" aria-label="Argentina.gob.ar Presidencia de la Nación">
            <img alt="Argentina.gob.ar" src="/proyectos/argentina/img/argentinagob.svg" height="50">
          </a>
          <a class="btn btn-success btn-login visible-xs" href="/proyectos/mi-argentina/v3/"><span class="fa fa-user fa-fw"></span></a>
          <a class="btn btn-primary btn-login visible-xs" href="#" onclick="$('.navbar.navbar-top').addClass('state-search');"><span class="fa fa-search fa-fw"></span></a>
        </div>

        <!--<ul class="nav navbar-nav navbar-right hidden-xs">
          <a href="#" onclick="$('.navbar.navbar-top').removeClass('state-search');" class="btn btn-link visible-xs"> <i class="fa fa-times"></i> </a>
          <li>
            <div class="input-group">
              
              <input id="buscar" type="text" class="form-control" aria-label="Buscar trámites, servicios o áreas" placeholder="Buscar trámites, servicios o áreas ...">
              <span class="input-group-btn">
                <button class="btn btn-primary" id="buscar-btn" type="button" aria-label="Buscar"><i class="fa fa-search"></i></button>
              </span>
            </div>
          </li>              
          <a href="#" class="dropdown-toggle btn btn-success hidden-xs" aria-label="Ingresar a Mi Argentina" data-toggle="dropdown"><i class="fa fa-user"></i> &nbsp; Mi Argentina</a>
        </ul>-->
        <ul class="nav navbar-nav navbar-right hidden-xs"> <a
            onclick="jQuery('.navbar.navbar-top').removeClass('state-search');" href="#"
            class="btn btn-link visible-xs"> <i class="fa fa-times"></i> </a>
          <div id="cd-login"> <a id="cd-login" href="https://mi.argentina.gob.ar" class="btn btn-link hidden-xs"
              aria-label="Ingresar a Mi Argentina"> <i class="icono-arg-mi-argentina"></i>Mi Argentina</a></div>
        </ul>
      </div>
    </div>
  </nav>

</header>


<script type="text/javascript">

  var busqueda = document.getElementById('buscar');
  var buscar = document.getElementById('buscar-btn');
  buscar.onclick = function () {
    var buscado = busqueda.value;
    location.href = "http://www.argentina.gob.ar/buscar/" + buscado;
  };
  
  //PONCHO LABS
  var url_string = window.location.href;
  var url = new URL(url_string);
  var lab = url.searchParams.get("lab");
  
  
  if(lab == ""){
    $("head").append('<link href="/proyectos/argentina/pruebas/poncho_lab.css" rel="stylesheet">');
  }
</script>

    <main role="main">
      <section class="jumbotron" style="background-image: url('/sites/default/files/eetb-gral.jpg');">
  <div class="jumbotron_bar">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <ol class="breadcrumb pull-left">
            <li><a href="/">Inicio</a></li>
            <li><a href="/elestadoentubarrio">El Estado en tu Barrio</a></li>
            <li class="active">San Luis</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <div class="jumbotron_body">
    <div class="container">
      <div class="row">
        <div class="col-md-7">
          
          <p><img src="/sites/default/files/el-estado-en-tu-barrrio.png" style="width: 320px;"> </p>
          <h1 class="sr-only">El estado en tu barrio - San Luis</h1>
          <p>Te acercamos las soluciones que vos y tu familia necesitan. A través de los servicios de El Estado en tu Barrio vas a poder resolver tus trámites, cerca de tu casa, de una manera fácil, rápida y sin intermediarios. Estamos haciendo lo que hay que hacer.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="overlay"></div>
</section>

<div class="container lugares-mapa hidden">
  <section>
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h2 class="text-center">El Estado en tu Barrio en San Luis</h2>
        <div id="map" style="height: 400px;"></div>
      </div>
    </div>
  </section>

  <section>
    <div class="row row-flex" data-render="barrios">
    </div>
  </section>    
</div>

<section>
  <div class="container">
    <div class="row">
      <div class="col-md-12 lugares-mensaje text-center hidden">
        <h2>Por el momento no estamos en San Luis</h2>
      </div>
      <div class="col-sm-12 text-center"> 
        <p>¿Querés que te avisemos cuando estemos cerca de tu casa?</p>
        <p><a href="https://contacto.casarosada.gob.ar/elestadoentubarrio/" target="_blank" class="btn btn-primary btn-success m-t-1">Registrate</a></p>
      </div>
    </div>
  </div>
</section>

<div class="container"> <hr> </div>

<section>
  <div class="container">
    <div id="servicios">
      <h2 class="text-center">Estos son los servicios y trámites que te acercamos</h2>
      <div class="row">    
        <div class="col-md-8 col-md-offset-2">
          <form role="search">
            <div class="input-group input-group-lg">
              <input class="form-control search" type="text" placeholder="Buscá el trámite que necesitás">
              <span class="input-group-btn">
                <button id="search" class="btn btn-primary" type="button"><span class="glyphicon glyphicon-search"></span></button>
              </span>
            </div>
          </form>
        </div>  
      </div>
      <div class="row">
        <div class="col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
          <div class="list" data-render="servicios"></div>
        </div> 
      </div>
    </div>
  </div>
</section>

<section class="bg-gray">
  <div class="container text-center">
    <h3>Mirá de qué se trata el Estado en tu Barrio</h3>
    <a target="_blank" href="https://www.youtube.com/playlist?list=PLry2W0bcBZ9wVhqAZJoYGBw2kKO4HL22A" class="btn btn-primary btn-lg">
      <i class="fa fa-video-camera fa-fw fa-2x" style="vertical-align: sub;"></i> &nbsp; 
      Ver los videos
    </a>
  </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/locale/es.js"></script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAnjrx-mfaup3A-TQS4DyL0ngfxEqDDBqc&region=AR&callback=initMap"></script>

<script> var idProvincia = 28; </script>

<script>
    jQuery('[data-render=mes]').text( moment().format('MMMM') );

  var initMap = function(){

    var templates = {
      barrio: '<div class="col-xs-12 col-sm-6 col-md-4 m-y-1"><h4 class="m-t-2">{lugar}</h4><div data-estado="estado" class="alert alert-warning {alerta}"><div class="media"><div class="media-left media-middle"><i class="fa fa-warning fa-fw fa-2x"></i></div><div class="media-body"><p class="m-b-0"><small><span>{estado}</span></small></p></div></div></div><p id="fecha-{index}" class="{escondido}"><strong>Fecha:</strong> Desde el {inicio} hasta el {fin}.</p><p><strong>Horario:</strong> {hora}</p><p><strong>Dirección:</strong> {direccion}</p></div>',
      servicios: '<h5 class="m-t-3">{categoria}</h5><div id="servicios-{i}"><ul class="list">',
    }

    var listado = [];
    var markers = [];
    var categoriasServicios = [];
    var listadoServicios = [];

    var render = {
      barrios: function( ){


        jQuery('[data-render=barrios]').html('');

        
        if( listado.length == 0 ){
          jQuery('.lugares-mensaje').removeClass('hidden');

        }else{
          jQuery('.lugares-mapa').removeClass('hidden');

          // Setup map

          var mapCenter = {lat: -41.2148693, lng: -66.3996161};
          var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 4,
            center: mapCenter,
            scrollwheel: false
          });

          var latlngbounds = new google.maps.LatLngBounds();

          jQuery.each(listado, function(index, item){

            var html = templates.barrio;

            var escondido;

            html = html
            .replace(/{index}/gi, item.index)
            .replace(/{inicio}/gi, item.inicio)
            .replace(/{fin}/gi, item.fin)
            .replace(/{hora}/gi, item.hora)
            .replace(/{direccion}/gi, item.direccion)
            .replace(/{lugar}/gi, item.lugar)
            .replace(/{escondido}/gi, item.fijo.replace("no","").replace("si","hidden"))
            .replace(/{estado}/gi, item.estado);

            var urlMarker = "https://www.argentina.gob.ar/sites/default/files/marker.png";

            if(item.estado != '') {
              html = html.replace(/{alerta}/gi, '');
              urlMarker = "https://www.argentina.gob.ar/sites/default/files/marker_disabled.png";
            }else{
              html = html.replace(/{alerta}/gi, 'hidden');
            }

            jQuery('[data-render=barrios]').append( html );



            var index = markers.length;
            markers[index] = new google.maps.Marker({
              map: map,
              position: {lat: parseFloat(item.lat), lng: parseFloat(item.lng)},
              title: item.lugar,
              icon: {
                url: urlMarker,
                size: new google.maps.Size(20, 20),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(10, 10)
              }





            });

            latlngbounds.extend( new google.maps.LatLng( parseFloat(item.lat), parseFloat(item.lng) ) );

            markers[index].addListener('click', function() {
              jQuery('[data-render=barrios] > div').removeClass('bg-gray').eq( index ).addClass('bg-gray');
                 jQuery('html,body').animate({
                   scrollTop:  jQuery('[data-render=barrios] > div').eq( index ).offset().top
                 }, '500', 'swing' );
            });



          });

          map.setCenter(latlngbounds.getCenter());
          map.setZoom( 16 );
          

          jQuery('body').on('click', '[data-render=barrios] > div', function(){
            jQuery('[data-render=barrios] > div').removeClass('bg-gray').eq( jQuery(this).index() ).addClass('bg-gray');
            map.setCenter( markers[jQuery(this).index()].getPosition() );
            map.setZoom( 11 );
          });

        }

      },
      servicios: function( ){

        jQuery('[data-render=servicios]').html('');

        window.serviciosList = [];

        jQuery.each(listadoServicios, function(index, items){

          var html = templates.servicios;

          html = html
          .replace(/{categoria}/gi, categoriasServicios[index])
          .replace(/{i}/gi, index);

          jQuery.each(items, function(index, item){
            html += '<li><span class="servicio">'+ item +'</span></li>';
          });

          jQuery('[data-render=servicios]').append( html + '</ul></div>' );

          var listOptions = { 
            valueNames: [ 'servicio' ],
            fuzzySearch: {
              searchClass: "search",
              location: 0,
              distance: 100,
              threshold: 0.4,
              multiSearch: true
            }

          };
          serviciosList[index] = new List('servicios-'+ index, listOptions);

        });
      }      
    }

    jQuery.ajax({
      url: 'https://interfaces.argentina.gob.ar/api/public/v1.0/inap/1dhfOIhdVq8qCcH0vLN9BTaxseXrDI3J1MnBJtKftoRU/'+ idProvincia +'',
      data: 'json',
      success: function(response){

        jQuery.each(response.feed.entry, function(index, row){


          if( moment(row.gsx$inicio.$t, 'DD-MM-YYYY').isValid() 
              && moment(row.gsx$fin.$t, 'DD-MM-YYYY').isValid()
              && moment(row.gsx$inicio.$t, 'DD-MM-YYYY').isBefore( moment().add(30, 'days') )
              && moment(row.gsx$fin.$t, 'DD-MM-YYYY').isAfter( moment().add(-1, 'days') ) 
              && row.gsx$latitud.$t != ''
              && row.gsx$longitud.$t != '' 
              || row.gsx$fijo.$t == "si"
            ){


            

            listado.push({
              index: index,
              inicio: row.gsx$inicio.$t,
              fin: row.gsx$fin.$t,
              hora: row.gsx$hora.$t,
              direccion: row.gsx$direccion.$t,
              lugar: row.gsx$lugar.$t,
              lat: row.gsx$latitud.$t,
              lng: row.gsx$longitud.$t,
              estado: row.gsx$motivosuspendido.$t,
              fijo: row.gsx$fijo.$t
            });



          }

        });

        render.barrios();



      }
    });

    jQuery.ajax({
      url: 'https://interfaces.argentina.gob.ar/api/public/v1.0/inap/1-5MzclZq_0oIYxZqVy70P-KJZZ7yaWuL9ioTjBVX_yI/'+ idProvincia +'',
      data: 'json',
      success: function(response){

        jQuery.each(response.feed.entry, function(index, row){
          if( categoriasServicios.indexOf( row.gsx$categoria.$t ) == -1 ){
            categoriasServicios.push( row.gsx$categoria.$t )
            listadoServicios[ categoriasServicios.length - 1 ] = [ row.gsx$servicio.$t ];
          }else{
            var categoria = categoriasServicios.indexOf( row.gsx$categoria.$t );
            listadoServicios[ categoria ].push( row.gsx$servicio.$t );
          }
        });
        render.servicios();
      }
    });


    jQuery('body').on('mouseover', '[data-render=barrios] > div', function(){
      jQuery('[data-render=barrios] > div').css('cursor', 'pointer');
    });

    jQuery('#search').on('click', function(event){
      buscar();
      event.preventDefault();
    });

    jQuery('form[role=search]').on('submit', function(event){
      buscar();
      event.preventDefault();
    });



    var buscar = function(){
      var busqueda = jQuery('.search').val()
      jQuery.each(serviciosList, function(index, item){
        serviciosList[index].fuzzySearch( busqueda );

        if(serviciosList[index].matchingItems.length == 0){
          jQuery('#servicios-'+ index ).prev().addClass('hidden');
        }else{
          jQuery('#servicios-'+ index ).prev().removeClass('hidden');
        }
      });

      dataLayer.push({
        'event': 'UAtracking',
        'ua-category': 'Interacción',
        'ua-action': 'INT_BUSCAR TRAMITES_EETB',
        'ua-label': busqueda
      });
    }

  };
</script>
    </main>
    
<footer class="main-footer">
    <div class="container">
        <section>
            <div class="row">
                <div class="col-sm-6 col-sm-12">
                    <section class="block block-block clearfix"> <img class="image-responsive"
                            src="http://argob.github.io/poncho/plantillas/paginas-de-argentina/img/argentinagob.svg"
                            alt="Argentina.gob.ar - Presidencia de la Nación">
                        <p class="text-muted small m-b-2"> <a
                                href="https://creativecommons.org/licenses/by/4.0/deed.es" target="_blank">Los
                                contenidos de Argentina.gob.ar están licenciados bajo Creative Commons Atribución 4.0 Internacional</a></p>
                    </section>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="region region-footer2">
                        <section id="block-menu-menu-footer-2" class="block block-menu clearfix">
                            <ul class="menu ">
                                <li class="first leaf"><a href="/servicios">Trámites y servicios</a></li>
                                <li class="leaf"><a href="https://www.argentina.gob.ar/turnos">Turnos</a></li>
                                <li class="leaf"><a href="/organismos">Organismos del Estado</a></li>
                                <li class="leaf"><a href="http://mapadelestado.jefatura.gob.ar/">Mapa del Estado</a>
                                </li>
                                <li class="last leaf"><a href="/normativa">Leyes argentinas</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="region region-footer3">
                        <section id="block-menu-menu-footer-3" class="block block-menu clearfix">
                            <ul class="menu">
                                <li class="first leaf"><a href="/acerca">Acerca de este sitio</a></li>
                                <li class="leaf"><a href="/terminos-y-condiciones">Términos y condiciones</a></li>
                                <li class="last leaf"><a href="/ayuda">Ayuda</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>
        </section>
    </div>
</footer>

    
  </body>
</html>
